# Active Directory Shared Folder ğŸ“

**Objective:** We'll be creating and sharing a "Public" folder on a Windows Server, ensuring that all members of the "Domain Users" group can access it from any computer on the network. We'll set up the folder on the server, configure permissions, map it to users as a network drive (Q:), and then verify that everything works as intended using a Winfows 10 VM.

A user might use the "Public" folder to efficiently store and share important files, making it easier for team members to access and collaborate without relying on email. It can also serve as a centralized location for shared resources like templates or company policies, ensuring everyone has access to the latest versions. Additionally, the folder can be used for backing up critical data and collaborating on projects in real-time. An administrator might further refine access permissions to ensure that only authorized users can modify files, while others can view them as needed.

## Step 1: Create Folder

Create a folder named â€œPublicâ€ on the C: drive of the Win 2016 Server  following these steps:

- Open File Explorer and navigate to the C: drive.
- Right-click, select "New," then "Folder."
- Name the folder â€œPublicâ€

This is for demonstration only. In a live environment, it is not recommended to set up network shares from the C: drive of a server. Instead, add a secondary hard drive and use it for all shares. This keeps the data on the C: drive protected.

<div align="center">
<img src="https://i.postimg.cc/RV89SC7M/0.png" >
</div>

Weâ€™d like to allow any member of the â€œDomain Usersâ€ group to access the folder. In order to do this, Right-click the â€œPublicâ€ folder, select â€œProperties,â€ and go to the â€œSharingâ€ tab. Click the â€œAdvanced Sharingâ€ button.

<div align="center">
<img src="https://i.postimg.cc/yNhzyFwd/1.png" >
</div>

Next, Tick the "Share this folder" check box, ensure "Public" is the "Share name," and click the "Permissions" button. In the "Groups or user names" text box, select "Everyone," then click the "Remove" button.

<div align="center">
    <img src="https://i.postimg.cc/HkymVGzb/2.png" >
</div>

Now, click the â€œAddâ€¦â€ button. Enter â€œDomainâ€ into the â€œEnter the object names to select (examples):â€ text box, then click the â€œCheck Namesâ€ button. Select the â€œDomain Usersâ€ group from the â€œMatching names:â€ list and click â€œOKâ€.

<div align="center">
    <img src="https://i.postimg.cc/hGRBmCZ6/3.png" >
</div>

Then, click â€œOKâ€ on the below dialogue box:

<div align="center">
    <img src="https://i.postimg.cc/50xW7XVm/4.png" >
</div>

In the â€œPermissions for Publicâ€ dialogue box, tick the â€œFull Controlâ€ check box. By doing so, the â€œChangeâ€ check box will also automatically be ticked. Next, click â€œOKâ€ and then click â€œOKâ€ again on the â€œAdvanced Sharingâ€ dialogue box.

<div align="center">
    <img src="https://i.postimg.cc/fLBn6MWQ/5.png" >
</div>

In order to finish this step, click on the â€œCloseâ€ button on the â€œPublic Propertiesâ€ box.

<div align="center">
    <img src="https://i.postimg.cc/XqqSWtXG/6.png" >
</div>

## Step 2: Mapping the Shared Folder to the Domain Users

Since the users who need access to the "Public" share are spread across various OUs (See the structure we set up, <a href="https://github.com/cybersecfaizan/Active-Directory-Ecosystem/blob/main/1.%20Active%20Directory%20Users%20and%20Organizational%20Units%20Setup.MD/" target="_blank">Here</a>
, we will create queries to search for and manage them efficiently. We can take advantage of the consistent login name format used in this domain, where the first letter of the first name is followed by a dot and then the last name (For example, j.musashi).

Open â€œServer Managerâ€, click on â€œToolsâ€ and click on â€œActive Directory Users and Computers.â€

<div align="center">
    <img src="https://i.postimg.cc/GhZw07Rt/7.png" >
</div>

Next, right-click â€œSaved Queriesâ€ and select â€œNewâ€ and then â€Queryâ€.

<div align="center">
    <img src="https://i.postimg.cc/5yrc2pFP/8.png" >
</div>

Name the New Query â€œEnd Usersâ€ and add a description if youâ€™d like. The â€œQuery root:â€ is set to â€œ..\labscholas,â€ meaning the search will cover the entire domain. To narrow the search to a specific OU or location, you can adjust the Query root accordingly.

<div align="center">
    <img src="https://i.postimg.cc/xjpV5jFK/9.png" >
</div>

In the dialogue box Select â€œUsers, Contacts, and Groupsâ€ from the â€œFindâ€ dropdown menu. Select the â€œAdvancedâ€ tab and click the â€œFieldâ€ button.

<div align="center">
    <img src="https://i.postimg.cc/DyWkMVtR/10.png" >
</div>

Select â€œUserâ€and then â€Logon Nameâ€ from the menu.

<div align="center">
    <img src="https://i.postimg.cc/bvh7rZsj/11.png" >
</div>

From the â€œCondition:â€ dropdown menu, select â€œIs (exactly).â€ In the â€œValue:â€ field, enter â€œ.â€ (star dot star), which acts as a wildcard. This will search for any logon name in the format â€œanything dot anything,â€ matching the naming convention we use for our users. Then, click the â€œAddâ€ button, and then the â€œOKâ€ Button.

<div align="center">
    <img src="https://i.postimg.cc/dVrMJ2QB/12.png" >
</div>

To finish creating the new query, click â€œOKâ€ on the â€œNew Queryâ€ dialogue box.

The â€œOur Usersâ€ query will now appear under â€œSaved Queries,â€ and the list of users it generates will be displayed in the right pane. Since itâ€™s saved, you can easily run this query again as needed.

<div align="center">
    <img src="https://i.postimg.cc/MGmhQzQf/13.png" >
</div>

Highlight all the users, then right click and choose â€œPropertiesâ€ from the menu.

<div align="center">
    <img src="https://i.postimg.cc/G236P6F7/14.png" >
</div>

In the â€œProperties for Multiple Itemsâ€ dialogue box, head over to the â€œProfileâ€ tab. Check the â€œHome folderâ€ box, choose the â€œConnectâ€ option, and assign the drive letter â€œQ:â€. Map it to \\Server1\Public, which is the UNC path of the folder we created and shared earlier in this lab. Once thatâ€™s done, click â€œOK.â€

<div align="center">
    <img src="https://i.postimg.cc/Y9XZd88p/15.png" >
</div>

Click â€œOKâ€ on the warning below.

<div align="center">
    <img src="https://i.postimg.cc/MHv4NRr1/16.png" >
</div>

## Step 3: Test Mapping of "Public" Folder

To verify that the â€œPublicâ€ folder is accessible to any user of the specified domain, reboot or power on Windows 10 and login using the credentials of a user created in the previous project. We will be logging in as Joe Musashi, so the username would be â€œj.musashiâ€ and the password, which the user will have to change when first logging in is â€œPass1234!â€

Open â€œFile Explorerâ€ and navigate to â€œThis PCâ€, where you should see the â€œPublic (\\\Server1)(Q:)â€ share displayed. Test it by clicking on it creating a folder for the user.

<div align="center">
    <img src="https://i.postimg.cc/1X2TQtL2/17.png" >
</div>

And thatâ€™s it! Users in the domain can now easily share files and resources.
